<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><script src="webpack.min.js"></script></head><body><dom-module id="data-location"><script>class DataLocation extends Polymer.Element{static get is(){return"data-location"}getLocation(){return new Promise(resolve=>{if(navigator.geolocation){navigator.geolocation.getCurrentPosition(position=>{resolve({latitude:position.coords.latitude,longitude:position.coords.longitude})},err=>{resolve(Error(err))},{enableHighAccuracy:!0,timeout:7e3,maximumAge:0})}})}toGeohash(latitude,longitude){return new Promise(resolve=>{const ratio=[16,8,4,2,1],geoFence=[];let values=[100*(longitude/180),100*(latitude/90)];for(let i=0;i<values.length;i++){geoFence[i]=[-100,100]}let geoHash="",number=0,character=0,i=0;while(10>geoHash.length){const iteration=i++%values.length,distance=geoFence[iteration],value=values[iteration],mean=(distance[0]+distance[1])/2;if(value>mean){character|=ratio[number];distance[0]=mean}else{distance[1]=mean}if(4>number){number++}else{geoHash+="0123456789bcdefghjkmnpqrstuvwxyz"[character];number=0;character=0}}resolve(geoHash)})}_toLatLon(geoHash){return new Promise(resolve=>{const ratio=[16,8,4,2,1],geoFence=[];for(let i=0;2>i;i++){geoFence[i]=[-100,100]}let iteration=0;for(let i=0;i<geoHash.length;i++){for(let x=0;x<ratio.length;x++){let distance=geoFence[iteration++%geoFence.length],side="0123456789bcdefghjkmnpqrstuvwxyz".indexOf(geoHash[i])&ratio[x]?0:1;distance[side]=(distance[0]+distance[1])/2}}const mean=[];for(let i=0;i<geoFence.length;i++){mean[i]=(geoFence[i][0]+geoFence[i][1])/2}resolve({latitude:90*(mean[1]/100),longitude:180*(mean[0]/100)})})}_distance(latA,lonA,latB,lonB){return new Promise(resolve=>{var _Mathsqrt=Math.sqrt,_Mathcos=Math.cos,_Mathsin=Math.sin;let phi1=this._radians(latA),phi2=this._radians(latB),deltaPhi=this._radians(latB-latA),deltaLambda=this._radians(lonB-lonA),amp=_Mathsin(deltaPhi/2)*_Mathsin(deltaPhi/2)+_Mathcos(phi1)*_Mathcos(phi2)*_Mathsin(deltaLambda/2)*_Mathsin(deltaLambda/2),circ=2*Math.atan2(_Mathsqrt(amp),_Mathsqrt(1-amp));resolve(Math.round(6371e3*circ))})}_radians(degrees){return degrees*Math.PI/180}}window.customElements.define(DataLocation.is,DataLocation);</script></dom-module></body></html>